@model IEnumerable<PMMX.Modelo.Entidades.Operaciones.Evento>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    @Styles.Render("~/Style/Bootstrap")
    @Styles.Render("~/Style/Font-Awesome")
    @Styles.Render("~/Style/FullCalendar")
    @Styles.Render("~/Style/AdminLTE")
}
<link rel="stylesheet" href="~/bower_components/fullcalendar/dist/fullcalendar.print.min.css" media="print">

<h2>Index</h2>
<p>
    <i class="fa fa-plus-circle text-green"></i>
    @Html.ActionLink("Create New", "Create")
</p>

<div id='calendar' style="width: 70%; height: 70%; max-width: 900px; margin: 0 auto;"></div>


@section Scripts {
        @Scripts.Render("~/JS/Moment")
        @Scripts.Render("~/JS/jquery")
        @Scripts.Render("~/JS/FullCalendar")
        <script>
            $(document).ready(function ()
            {
                GetEvents();

                function GetEvents()
                {
                    $.ajax({
                        dataType: "json",
                        contentType: "application/json",
                        data: "{}",
                        url: "/Evento/GetEvents",
                        dataType: "json",
                        success: function (data) {
                            $('#calendar').fullCalendar({
                                theme: false,
                                header: {
                                    left: 'prev,next today',
                                    center: 'title',
                                    right: 'month,basicWeek,basicDay'
                                },
                                defaultView: 'month',
                                editable: false,
                                lang: 'es',
                                eventLimit: 4,
                                eventLimitText: 'More',
                                weekMode: 'liquid',
                                events: $.map(data.events, function (item, i) {
                                    var event = new Object();
                                    event.start = moment(item.FechaInicio).utc();
                                    event.end = moment(item.FechaFin).utc();
                                    event.title = item.Descripcion;
                                    event.brief = item.Nota;
                                    event.id = item.Id;
                                    event.url = "/Operaciones/Evento/Details/" + item.Id;
                                    return event;
                                }),

                            });

                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            alert('There was an error while fetching events!');
                        }
                    });
                }

            });
        </script>
    }
